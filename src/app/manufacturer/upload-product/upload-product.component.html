<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
/>

<div class="container mt-5">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>{{ 'MANUFACTURER_UPLOAD_PRODUCTS' | translate }}</h2>
    <a class="btn btn-primary btn-lg" style="background: #03A9F4" (click)="downloadFile()">
      {{ 'MANUFACTURER_DOWNLOAD_TEMPLATE' | translate }}
    </a>
  </div>

  <div class="alert alert-danger" role="alert" *ngIf="fileErrors.length > 0">
    <h4 class="alert-heading">{{ 'FILE_ERROR' | translate }}</h4>
    <p *ngFor="let err of fileErrors">{{ err }}</p>
    <hr>
    <p class="mb-0">{{ 'FILE_VALIDATION_MESSAGE' | translate }}</p>
  </div>

  <div class="alert alert-success" role="alert" *ngIf="fileErrors.length === 0 && isFileUploaded">
    <h4 class="alert-heading">{{ 'FILE_SUCCESS' | translate }}</h4>
    <p>{{ 'FILE_VALIDATION_SUCCESS_MESSAGE' | translate }}</p>
  </div>

  <div class="card">
    <div class="card-header">
      {{ 'MANUFACTURER_UPLOAD_NEW_PRODUCTS' | translate }}
    </div>
    <div class="card-body">
      <div class="table-responsive" style="max-height: 400px; overflow-y: auto; overflow-x: auto;">
        <table class="table table-bordered table-striped" *ngIf="jsonData.length > 0">
          <thead class="table-dark">
            <tr>
              <th style="position: sticky; top: 0; z-index: 1; background: #343a40;">#</th>
              <th *ngFor="let key of jsonData[0] | keyvalue" style="position: sticky; top: 0; z-index: 1; background: #343a40;">
                {{ key.key }}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of jsonData; index as i">
              <td>{{ i+1 }}</td>
              <td *ngFor="let key of item | keyvalue">{{ key.value }}</td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

    <div class="card-footer">
      <div class="d-flex justify-content-end">

        <button class="btn btn-secondary me-2" (click)="clean()" [disabled]="isUploading">
          {{ 'COMMON.CANCEL' | translate }}
        </button>
        <label class="btn btn-success" *ngIf="!isFileUploaded && fileErrors.length === 0">
          <i class="bi bi-upload me-2"></i>
          {{ 'MANUFACTURER_UPLOAD_LOAD_FILE' | translate }}
          <input
            type="file"
            hidden
            (change)="uploadFile($event)"
          />
        </label>

        <button class="btn btn-primary me-2" (click)="uploadProducts()" *ngIf="isFileUploaded && fileErrors.length === 0" [disabled]="isUploading">
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" *ngIf="isUploading"></span>
          {{ 'MANUFACTURER_UPLOAD_SEND_FILE' | translate }}
        </button>

      </div>
    </div>
  </div>

</div>
